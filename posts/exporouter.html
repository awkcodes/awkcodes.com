<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Expo Router - Technical Documentation</title>
<link rel="stylesheet" type="text/css" href="newpost.css" />
</head><body>
<div class="container">

  <header>
    <h1>AWKcodes</h1>
  </header>

<h2>Expo Router</h2>
<p>This is a series of notes about Expo Router: how to set it up, how expo-router/entry works, the file-based routing model, APIs, and advanced usage patterns. this is just some notes for myself to study this technology to Learn more go to expo.dev.</p>
<p>References are linked inline to the official Expo docs.</p>
<hr />
<h4 id="project-setup">Project setup (new or existing)</h4>
<p>If you’re starting fresh, the fastest way is to create an Expo app that already includes Expo Router:</p>
<pre data-language="bash"><code class="language-bash">npx create-expo-app@latest
cd your-app
npx expo start
</code></pre>
<p>If you’re adding Expo Router to an existing project, install dependencies and set the entry:</p>
<pre data-language="bash"><code class="language-bash">npx expo install expo-router react-native-safe-area-context react-native-screens expo-linking expo-constants expo-status-bar
</code></pre>
<p>Set your app entry to expo-router/entry (package.json):</p>
<pre data-language="json"><code class="language-json">{
  &quot;main&quot;: &quot;expo-router/entry&quot;
}
</code></pre>
<p>If you want a custom entry to initialize analytics, etc., create index.js and import expo-router/entry last, then point package.json main to index.js. The key is: import ‘expo-router/entry’ last so your side effects initialize first. See docs: Install Expo Router → “Setup entry point”</p>
<p>if you are creating using create-expo-router it comes pre-imported by default in the index.js alone so you just add anything that you want to add before it.</p>
<p><a href="https://docs.expo.dev/router/installation/">docs.expo.dev/router/installation</a>.</p>
<pre><code class="language-js">// index.js   
import './init-analytics';
import 'react-native-gesture-handler'; // example polyfill 
// import ... ...


import 'expo-router/entry'; // and just put expo-router in the end
</code></pre>
<hr />
<h4>expo-router/entry  (the “entrypoint”)</h4>
<p>file-based-routes of expo-router/entry registers the Router as your app’s root and wires the router to a dynamic route manifest generated from your app directory at building or running time.The Router discovers routes via require.context on the ./app directory. This behavior depends on a Babel plugin (expo-router/babel) and Metro’s support for context modules.</p>
<p>Troubleshooting docs and background here: <a href="https://docs.expo.dev/router/reference/troubleshooting/">docs.expo.dev/router/reference/troubleshooting</a>. The “Setup entry point” behavior is in the install guide: <a href="https://docs.expo.dev/router/installation/">docs.expo.dev/router/installation</a>. Expo Router relies on Metro and the expo/metro-config integration that enables context modules; see the troubleshooting note for require.context and Metro config.</p>
<p>Internally, Expo Router layers on top of React Navigation. File-based routes are compiled into a navigation tree with stacks/tabs/drawers as defined by your _layout files. for introduction and reference: <a href="https://docs.expo.dev/router/introduction/">docs.expo.dev/router/introduction</a>, <a href="https://docs.expo.dev/versions/latest/sdk/router/">docs.expo.dev/versions/latest/sdk/router</a>.</p>
<hr />
<h4>File-based routing</h4>
<p>Create an app/ directory in your project root folder. Any file under app/ becomes a route; _layout files define navigators.</p>
<ul>
<li>Static routes use simple filenames like app/about.tsx → /about.</li>
<li>Dynamic routes use [param] or catch-alls like […slug]</li>
<li>Route groups (directories wrapped in parentheses) group routes without affecting the URL, e.g. app/(tabs)/settings.tsx → /settings.</li>
<li>index.tsx is the default in its directory (like / or /profile).</li>
<li>Layout files _layout.tsx define navigators and shared wrappers for child routes.</li>
<li>[NOTE]Special “+” files like +not-found, +html, +middleware provide framework features.</li>
</ul>
<p>Notation reference: <a href="https://docs.expo.dev/router/basics/notation/">docs.expo.dev/router/basics/notation</a>. File-based routing overview: <a href="https://docs.expo.dev/develop/file-based-routing/">docs.expo.dev/develop/file-based-routing</a>.</p>
<p>Basic home route:</p>
<pre><code class="language-tsx">// app/index.tsx
import { View, Text, StyleSheet } from 'react-native';

export default function Home() {
  return (
    &lt;View style={styles.container}&gt;
    &lt;Text&gt;Home Page Display&lt;/Text&gt;
    &lt;/View&gt;
  );
}

const styles = StyleSheet.create({
  container: { flex: 1, alignItems: 'center', justifyContent: 'center' }
});
</code></pre>
<p>Root layout with a Stack navigator:</p>
<pre><code class="language-tsx">// app/_layout.tsx
import { Stack } from 'expo-router';

export default function RootLayout() {
  return (
    &lt;Stack
    screenOptions={{
    headerTitleAlign: 'center'
    }}
    /&gt;
  );
}
</code></pre>
<p>Core concepts explain why _layout is “rendered before any other route” : <a href="https://docs.expo.dev/router/basics/core-concepts/">docs.expo.dev/router/basics/core-concepts</a>.</p>
<hr />
<h4>Navigation patterns with file structure</h4>
<p>Stacks, Tabs, and Drawers are expressed by nested _layout.tsx files inside the directories.</p>
<p>Tabs example:</p>
<pre><code class="language-tsx">// app/(tabs)/_layout.tsx
import { Tabs } from 'expo-router';

export default function TabsLayout() {
  return (
    &lt;Tabs screenOptions={{ headerShown: false }}&gt;
    &lt;Tabs.Screen name=&quot;index&quot; options={{ title: 'Main' }} /&gt;
    &lt;Tabs.Screen name=&quot;settings&quot; options={{ title: 'Settings' }} /&gt;
    &lt;/Tabs&gt;
  );
}
</code></pre>
<pre><code class="language-tsx">// app/(tabs)/index.tsx
import { View, Text } from 'react-native';

export default function Main() {
  return &lt;View&gt;&lt;Text&gt;Main page&lt;/Text&gt;&lt;/View&gt;;
}

// app/(tabs)/settings.tsx
export default function Settings() {
  return &lt;View&gt;&lt;Text&gt;Settings&lt;/Text&gt;&lt;/View&gt;;
}
</code></pre>
<p>Because (tabs) is a group, the URLs are / and /settings. More patterns are in Router 101 and Navigation patterns. API reference for Stack and Tabs usage: <a href="https://docs.expo.dev/versions/latest/sdk/router/">docs.expo.dev/versions/latest/sdk/router</a>.</p>
<hr />
<h4>Dynamic routes</h4>
<p>Create a dynamic segment with square brackets. Then link to it and read params.</p>
<pre><code class="language-tsx">// app/user/[id].tsx
import { useLocalSearchParams } from 'expo-router';
import { Text, View } from 'react-native';

export default function User() {
  const { id } = useLocalSearchParams();
  return &lt;View&gt;&lt;Text&gt;User ID: {id}&lt;/Text&gt;&lt;/View&gt;;
}
</code></pre>
<pre><code class="language-tsx">// app/index.tsx (link to dynamic route)
import { Link } from 'expo-router';
import { View } from 'react-native';

export default function Home() {
  return (
    &lt;View&gt;
    &lt;Link href=&quot;/user/1&quot;&gt;View User 1&lt;/Link&gt;
    &lt;Link href={{ pathname: '/user/[id]', params: { id: 'bacon' } }}&gt;
    View User bacon
    &lt;/Link&gt;
    &lt;/View&gt;
  );
}
</code></pre>
<p>Dynamic routing guide: <a href="https://docs.expo.dev/develop/dynamic-routes/">docs.expo.dev/develop/dynamic-routes</a>.</p>
<p>[NOTE]:catch-alls use […slug].</p>
<hr />
<h4>Link and Router APIs</h4>
<ul>
<li>Use Link for declarative navigation. It supports push, replace, dismissTo, prefetch, and more.</li>
<li>Use the Router for imperative navigation: router.push(’/path’), router.back(), router.replace(’/path’).</li>
</ul>
<pre><code class="language-tsx">// Declarative
import { Link } from 'expo-router';

&lt;Link href=&quot;/settings&quot; replace&gt;Go to Settings&lt;/Link&gt;

// Imperative
import { useRouter } from 'expo-router';
const router = useRouter();
router.push('/settings');
</code></pre>
<p>the Router API reference: <a href="https://docs.expo.dev/versions/latest/sdk/router/">docs.expo.dev/versions/latest/sdk/router</a></p>
<p>[Note]Useful hooks:</p>
<ul>
<li>usePathname() returns the current path.</li>
<li>useLocalSearchParams() returns focused route params.</li>
<li>useGlobalSearchParams() returns params even when unfocused.</li>
<li>useNavigation() gives direct access to the underlying React Navigation object for a given layout (e.g., openDrawer()).</li>
<li>useFocusEffect() to run effects when a screen gets focused.</li>
</ul>
<p>API reference for these hooks: <a href="https://docs.expo.dev/versions/latest/sdk/router/">docs.expo.dev/versions/latest/sdk/router</a>. URL param handling: <a href="https://docs.expo.dev/router/reference/url-parameters/">docs.expo.dev/router/reference/url-parameters</a></p>
<hr />
<h4>Reading and typing URL/search params</h4>
<pre><code class="language-tsx">// app/search.tsx
import { useLocalSearchParams } from 'expo-router';
import { Text } from 'react-native';

export default function Search() {
  const { q } = useLocalSearchParams&lt;{ q?: string }&gt;();
  return &lt;Text&gt;Query: {q ?? 'none'}&lt;/Text&gt;;
}
</code></pre>
<p>If you enable typed routes, you can strongly type route params and hrefs across the app. URL parameter docs: <a href="https://docs.expo.dev/router/reference/url-parameters/">docs.expo.dev/router/reference/url-parameters</a>.</p>
<hr />
<h4>Typed routes (TypeScript)</h4>
<p>Typed routes make your Link and router calls type-safe and catch invalid hrefs at compile time. Enable the experiment:</p>
<pre><code class="language-json">// app.json
{
  &quot;expo&quot;: {
    &quot;experiments&quot;: {
    &quot;typedRoutes&quot;: true
    }
  }
}
</code></pre>
<p>Run the dev server once; Expo CLI generates types (expo-env.d.ts) and augments your tsconfig includes. Then:</p>
<pre><code class="language-tsx">import { Link, useLocalSearchParams, useRouter } from 'expo-router';

// Type-checked hrefs
&lt;Link href=&quot;/about&quot; /&gt;
&lt;Link href={{ pathname: '/user/[id]', params: { id: '123' }}} /&gt;

// Errors:
// &lt;Link href=&quot;/usser/1&quot; /&gt; // misspelled route (TypeScript error)
// &lt;Link href=&quot;/user/[id]&quot; /&gt; // dynamic route requires params object
</code></pre>
<p>You can also type search params per-route:</p>
<pre><code class="language-tsx">const { profile, search } = useLocalSearchParams&lt;'app/(search)/[profile]/[...search].tsx'&gt;();
</code></pre>
<p>Typed routes guide: <a href="https://docs.expo.dev/router/reference/typed-routes/">docs.expo.dev/router/reference/typed-routes</a>.</p>
<hr />
<h4>Special “+” files: +not-found, +html, +middleware, +native-intent</h4>
<ul>
<li>+not-found.tsx renders for unmatched routes.</li>
<li>+html.tsx customizes HTML for static web output (web-only).</li>
<li>+middleware.ts runs logic before route render (e.g., auth gates and redirects).</li>
<li>+native-intent.ts handles deep links that don’t directly map to a route.</li>
</ul>
<p>See notation doc for an overview: <a href="https://docs.expo.dev/router/basics/notation/">docs.expo.dev/router/basics/notation</a>. Explore Redirect and protected routes patterns in the navigation sections of the docs.</p>
<p>Simple redirect example:</p>
<pre><code class="language-tsx">// app/protected/index.tsx
import { Redirect } from 'expo-router';
import { useAuth } from '../providers/auth';

export default function Protected() {
  const { user } = useAuth();
  if (!user) return &lt;Redirect href=&quot;/login&quot; /&gt;;
  return /* protected UI */;
}
</code></pre>
<hr />
<h4>Shared routes and route groups</h4>
<p>Route groups let you duplicate or share screens across different layouts (common in native apps where a profile is viewable from multiple tabs). You can use overlapping groups or the array syntax to “duplicate” children.</p>
<p>Example: a single user route in both the home and search groups via array syntax:</p>
<pre><code class="language-tsx">// app/(home,search)/_layout.tsx
export const unstable_settings = {
  initialRouteName: 'home',
  search: { initialRouteName: 'search' }
};

export default function DynamicLayout({ segment }: { segment: string }) {
  if (segment === '(search)') {
    return &lt;SearchStack /&gt;;
  }
  return &lt;Stack /&gt;;
}

// app/(home,search)/[user].tsx
export default function User() { /* ... */ }
</code></pre>
<p>This produces app/(home)/[user].tsx and app/(search)/[user].tsx in memory and lets the same URL be rendered under different layouts. See “Shared routes” and array syntax: <a href="https://docs.expo.dev/router/advanced/shared-routes/">docs.expo.dev/router/advanced/shared-routes</a>.</p>
<hr />
<h4>Modals, nested navigators, and initial routes</h4>
<p>To make modals, place them in the same Stack and set screen options to modal presentation:</p>
<pre><code class="language-tsx">// app/_layout.tsx
import { Stack } from 'expo-router';

export default function RootLayout() {
  return (
    &lt;Stack&gt;
    &lt;Stack.Screen name=&quot;index&quot; options={{ title: 'Home' }} /&gt;
    &lt;Stack.Screen name=&quot;modal&quot; options={{ presentation: 'modal', title: 'Modal' }} /&gt;
    &lt;/Stack&gt;
  );
}
</code></pre>
<pre><code class="language-tsx">// app/modal.tsx
export default function Modal() { /* ... */ }
</code></pre>
<p>If your initial route/back button behavior is odd, set unstable_settings.initialRouteName at the layout level:</p>
<pre><code class="language-tsx">// app/_layout.tsx
export const unstable_settings = { initialRouteName: 'index' };
</code></pre>
<p>This is a known gotcha; see troubleshooting “Missing back button”: <a href="https://docs.expo.dev/router/reference/troubleshooting/">docs.expo.dev/router/reference/troubleshooting</a>.</p>
<hr />
<h4>Deep linking and scheme</h4>
<p>For native deep links, set a scheme in app.json and Expo Router will map URLs to routes automatically:</p>
<pre><code class="language-json">// app.json
{
  &quot;expo&quot;: {
    &quot;scheme&quot;: &quot;your-app-scheme&quot;
  }
}
</code></pre>
<p>Installation doc step for project configuration: <a href="https://docs.expo.dev/router/installation/">docs.expo.dev/router/installation</a>.</p>
<hr />
<h4>“How it works” — internals recap</h4>
<ul>
<li>File-based routes: Your app directory is parsed at build/dev time into a route manifest. Notation like (groups), [id], […slug], +files are compiled into navigation structures (Stack/Tabs/Drawer) defined by _layout.tsx files.</li>
<li>Entry and bootstrapping: expo-router/entry sets up the root NavigationContainer and web/native integration. It relies on Babel preset expo and plugin expo-router/babel to inject environment and enable require.context-based route discovery. This is why process.env.EXPO_ROUTER_APP_ROOT and Metro’s context modules matter; if misconfigured, you’ll see the related errors (see troubleshooting).</li>
<li>Navigation engine: Under the hood, Expo Router builds on React Navigation but eliminates a ton of boilerplate by deriving route trees from the file system. You can still drop down to React Navigation objects with useNavigation for imperative features (like opening a Drawer).</li>
<li>Bundler: Metro is used across native and web for consistent module resolution and features like deferred bundling. See migration notes for rationale: <a href="https://docs.expo.dev/router/migrate/from-expo-webpack/">docs.expo.dev/router/migrate/from-expo-webpack</a>.</li>
</ul>
<p>Key docs for internals and setup behavior:</p>
<ul>
<li>Install/setup/entry: <a href="https://docs.expo.dev/router/installation/">docs.expo.dev/router/installation</a></li>
<li>Troubleshooting (babel/Metro/require.context): <a href="https://docs.expo.dev/router/reference/troubleshooting/">docs.expo.dev/router/reference/troubleshooting</a></li>
<li>Router API &amp; hooks: <a href="https://docs.expo.dev/versions/latest/sdk/router/">docs.expo.dev/versions/latest/sdk/router</a></li>
<li>Notation: <a href="https://docs.expo.dev/router/basics/notation/">docs.expo.dev/router/basics/notation</a></li>
<li>File-based routing overview: <a href="https://docs.expo.dev/develop/file-based-routing/">docs.expo.dev/develop/file-based-routing</a></li>
<li>Intro/features: <a href="https://docs.expo.dev/router/introduction/">docs.expo.dev/router/introduction</a></li>
<li>Typed routes: <a href="https://docs.expo.dev/router/reference/typed-routes/">docs.expo.dev/router/reference/typed-routes</a></li>
<li>Dynamic routes: <a href="https://docs.expo.dev/develop/dynamic-routes/">docs.expo.dev/develop/dynamic-routes</a></li>
<li>Shared routes &amp; array syntax: <a href="https://docs.expo.dev/router/advanced/shared-routes/">docs.expo.dev/router/advanced/shared-routes</a></li>
</ul>
<hr />
<h4>End-to-end example: tabs + stack + dynamic + modal + types</h4>
<p>Here’s a compact app skeleton demonstrating the major features.</p>
<pre><code class="language-tsx">// app/_layout.tsx
import { Stack } from 'expo-router';
export const unstable_settings = { initialRouteName: '(tabs)' };

export default function RootLayout() {
  return (
    &lt;Stack&gt;
    &lt;Stack.Screen name=&quot;(tabs)&quot; options={{ headerShown: false }} /&gt;
    &lt;Stack.Screen name=&quot;modal&quot; options={{ presentation: 'modal', title: 'Compose' }} /&gt;
    &lt;/Stack&gt;
  );
}
</code></pre>
<pre><code class="language-tsx">// app/(tabs)/_layout.tsx
import { Tabs } from 'expo-router';
export default function TabsLayout() {
  return (
    &lt;Tabs&gt;
    &lt;Tabs.Screen name=&quot;index&quot; options={{ title: 'Feed' }} /&gt;
    &lt;Tabs.Screen name=&quot;search&quot; options={{ title: 'Search' }} /&gt;
    &lt;Tabs.Screen name=&quot;settings&quot; options={{ title: 'Settings' }} /&gt;
    &lt;/Tabs&gt;
  );
}
</code></pre>
<pre><code class="language-tsx">// app/(tabs)/index.tsx
import { Link } from 'expo-router';
import { View, Text, Button } from 'react-native';
import { useRouter } from 'expo-router';

export default function Feed() {
  const router = useRouter();
  return (
    &lt;View&gt;
    &lt;Text&gt;Feed&lt;/Text&gt;
    &lt;Link href=&quot;/user/42&quot;&gt;Go to User 42&lt;/Link&gt;
    &lt;Button title=&quot;Open Compose Modal&quot; onPress={() =&gt; router.push('/modal')} /&gt;
    &lt;/View&gt;
  );
}
</code></pre>
<pre><code class="language-tsx">// app/user/[id].tsx
import { useLocalSearchParams, Link } from 'expo-router';
import { View, Text } from 'react-native';

export default function User() {
  const { id } = useLocalSearchParams&lt;{ id: string }&gt;();
  return (
    &lt;View&gt;
    &lt;Text&gt;User {id}&lt;/Text&gt;
    &lt;Link href={{ pathname: '/user/[id]', params: { id: String(Number(id) + 1) } }}&gt;
    Next user
    &lt;/Link&gt;
    &lt;/View&gt;
  );
}
</code></pre>
<pre><code class="language-tsx">// app/modal.tsx
import { View, Text, TextInput, Button } from 'react-native';
import { useRouter } from 'expo-router';

export default function Compose() {
  const router = useRouter();
  return (
    &lt;View&gt;
    &lt;Text&gt;Compose&lt;/Text&gt;
    &lt;TextInput placeholder=&quot;Write something...&quot; /&gt;
    &lt;Button title=&quot;Send&quot; onPress={() =&gt; router.dismiss()} /&gt;
    &lt;/View&gt;
  );
}
</code></pre>
<pre><code class="language-tsx">// app/(tabs)/search.tsx
import { useLocalSearchParams, Link } from 'expo-router';
import { View, Text } from 'react-native';

export default function Search() {
  const { q } = useLocalSearchParams&lt;{ q?: string }&gt;();
  return (
    &lt;View&gt;
    &lt;Text&gt;Search query: {q ?? 'none'}&lt;/Text&gt;
    &lt;Link href=&quot;/(tabs)/search?q=expo&quot;&gt;Search &quot;expo&quot;&lt;/Link&gt;
    &lt;/View&gt;
  );
}
</code></pre>
<pre><code class="language-tsx">// app/+not-found.tsx
import { Link } from 'expo-router';
import { View, Text } from 'react-native';

export default function NotFound() {
  return (
    &lt;View&gt;
    &lt;Text&gt;Oops, that route does not exist.&lt;/Text&gt;
    &lt;Link href=&quot;/&quot;&gt;Go Home&lt;/Link&gt;
    &lt;/View&gt;
  );
}
</code></pre>
<p>Enable typed routes in app.json and enjoy typed hrefs.</p>
<hr />
<h4>Common pitfalls and fixes</h4>
<ul>
<li>Missing back button or wrong initial route: set unstable_settings.initialRouteName in the layout containing those screens.</li>
<li>EXPO_ROUTER_APP_ROOT/require.context errors: ensure babel-preset-expo is used and expo-router/babel is applied; clear cache with npx expo start –clear; ensure Metro config is not disabling context modules. See troubleshooting: <a href="https://docs.expo.dev/router/reference/troubleshooting/">docs.expo.dev/router/reference/troubleshooting</a>.</li>
<li>Always import ‘expo-router/entry’ last in custom entry files so your side effects run first before the app renders: <a href="https://docs.expo.dev/router/installation/">docs.expo.dev/router/installation</a>.</li>
</ul>
<hr />
<h4>When to drop down to React Navigation</h4>
<p>Expo Router is a superset on top of React Navigation. If you need advanced drawer control, direct stack actions, or highly customized transitions, use useNavigation() or screenOptions from React Navigation as usual. The Router keeps those escape hatches available while giving you a fast, typed, URL-first developer experience. here is the Router API reference: <a href="https://docs.expo.dev/versions/latest/sdk/router/">docs.expo.dev/versions/latest/sdk/router</a>.</p>
<hr />

  <footer>
    &copy; 2025 Abdallah Khalaf. All rights reserved.
  </footer>
</body>
</html>
